# å¼€å‘æ–‡æ¡£

## â‡ï¸ Docs

- [deck.gl events](https://deck.gl/docs/developer-guide/interactivity#picking)
  - [getTooltip](https://deck.gl/docs/api-reference/core/deck#gettooltip)
    - `<DeckGL />` æ ¹èŠ‚ç‚¹ä¸Šçš„å±æ€§ï¼Œä»»ä½•é¼ æ ‡ç§»åŠ¨éƒ½ä¼šè¢«ç›‘å¬ï¼Œéœ€è¦åŸºäº `picked` å±æ€§åˆ¤æ–­æ˜¯å¦åœ¨ç›®æ ‡å…ƒç´ ä¸Šæ–¹ã€‚



## â‡ï¸ ç›®å½•ç»“æ„è§„èŒƒ

âœ… å·¥ç¨‹è§„èŒƒçº¦å®š

- å·¥ç¨‹ä¸‹æ‰€æœ‰æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹å‘½åéµå¾ª(å°å†™ + `-` è¿å­—ç¬¦)
- æ ¹è·¯å¾„ä¸‹ç›®å½•é™¤é…ç½®æ–‡ä»¶å’Œ src å¤–åªèƒ½å­˜åœ¨ binã€configã€publicã€testé…ç½®ç›¸å…³ç›®å½•
- å…¬å…±ç±»åº“ç›¸å…³æ–‡ä»¶æš‚åªæ”¯æŒå­˜åœ¨ apiã€assetsã€stylesã€hooksã€libã€storeã€typesã€constantsï¼ŒæŒ‰éœ€ä»¥æ–‡ä»¶æˆ–ç›®å½•åˆ›å»ºï¼Œå¦‚ style.scss æˆ– styles/index.scssï¼Œæ”¯æŒåˆ›å»ºå­ç›®å½•
- pages ç›®å½•ï¼Œæ”¯æŒ spaã€mpaã€mpa + spa
- spa æ‰“åŒ…å…¥å£æ–‡ä»¶å’Œæ ¹ç»„ä»¶å‘½åå¿…é¡»æ˜¯ main.tsxã€app.tsx
- é¡µé¢å’Œç»„ä»¶æ”¯æŒå¯åµŒå¥—

âœ… `src/` æ ¹ç›®å½•ç»“æ„

```
â”œâ”€â”€ src
â”‚Â Â  â”œâ”€â”€ api  // åå°æ¥å£æœåŠ¡
â”‚Â Â  â”‚Â Â  â””â”€â”€ index.ts 
â”‚Â Â  â”œâ”€â”€ assets // å…¬å…±é™æ€èµ„æºç›®å½•
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ fonts // å­—ä½“æ–‡ä»¶
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ icons // icon
â”‚Â Â  â”‚Â Â  â””â”€â”€ images // å›¾ç‰‡
â”‚Â Â  â”œâ”€â”€ styles // cssæ ·å¼ å•ç‹¬ä»assetsæ‹å‡ºæ¥æ˜¯è€ƒè™‘åˆ°sassæ˜¯éœ€è¦ç¼–è¯‘å¤„ç†è€Œä¸åƒå­—ä½“å›¾æ ‡ç›´æ¥å¯ä½¿ç”¨
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ index.scss // é»˜è®¤å…¨å±€æ ·å¼
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ index.module.scss // css module
â”‚Â Â  â”œâ”€â”€ components // å…¬å…±ç»„ä»¶
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ component-a
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ api// æœåŠ¡æ¥å£
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ assets // é™æ€èµ„æº åŒä¸Š
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ lib // ç±»åº“ åŒä¸Š
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ constants // å¸¸é‡ åŒä¸Š
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ styles // æ ·å¼ åŒä¸Š
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ types // ç±»å‹å£°æ˜ åŒä¸Š
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ components // å­ç»„ä»¶
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ sub-component // ç»“æ„åŒä¸Š
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ assets
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ index.tsx
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ index.tsx // ç»„ä»¶å…¥å£
â”‚Â Â  â”‚Â Â  â””â”€â”€ component-b
â”‚Â Â  â”‚Â Â      â””â”€â”€ index.tsx
â”‚Â Â  â”œâ”€â”€ hooks // React Hooks
â”‚Â Â  â”‚Â Â  â””â”€â”€ use-hook-a // æ–‡ä»¶å¤¹
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ index.ts
â”‚Â Â  â”œâ”€â”€ lib // å·¥å…·åº“ ç±»ä¼¼äºutils
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ create-store // ä»¥æ–‡ä»¶å¤¹ é€šè¿‡indexå…¥å£æš´éœ²
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ index.ts
â”‚Â Â  â”œâ”€â”€ store // å…¬å…±çŠ¶æ€åº“
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ index.ts
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ features
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ sliceA
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ index.ts // the Redux logic for the feature
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ sliceB
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ index.ts
â”‚Â Â  â””â”€â”€ types // tsç±»å‹å£°æ˜
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ index.d.ts
â”‚Â Â  â”œâ”€â”€ pages // MPA pagesä¸‹çš„æ¯ä¸ªæ–‡ä»¶å¤¹éƒ½ä¼šè¢«ä½œä¸ºä¸€ä¸ªentryæ¥è¿›è¡Œæ‰“åŒ…
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ page-a
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ app.tsx // æ ¹ç»„ä»¶ å‘½åå›ºå®š
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ main.tsx // æ‰“åŒ…å…¥å£æ–‡ä»¶ å‘½åå›ºå®š
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ assets // ç»“æ„ä¸æœ€å¤–å±‚assetsä¸€æ · ç»“æ„ä¸æœ€å¤–å±‚assetsä¸€æ ·
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ components // page-aä¸‹å…¬å…±ä¸šåŠ¡ç»„ä»¶ ç»“æ„ä¸æœ€å¤–å±‚componentsä¸€æ ·
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ hooks // viewså…¬å…±hooks ç»“æ„ä¸æœ€å¤–å±‚hooksä¸€æ ·
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ lib // viewså…¬å…±å·¥å…·åº“ ç»“æ„ä¸æœ€å¤–å±‚libä¸€æ ·
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ routes // è·¯ç”±
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ index.ts
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ store // viewså…¬å…±çŠ¶æ€  ç»“æ„ä¸æœ€å¤–å±‚storeä¸€æ ·
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ styles // viewså…¬å…±æ ·å¼  ç»“æ„ä¸æœ€å¤–å±‚stylesä¸€æ ·
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ index.scss
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ constants // viewså…¬å…±å¸¸é‡ ç»“æ„ä¸æœ€å¤–å±‚constantsä¸€æ ·
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ index.ts
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ types // viewså…¬å…±stç±»å‹å£°æ˜ ç»“æ„ä¸æœ€å¤–å±‚typesä¸€æ ·
â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ index.d.ts
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ views // é¡µé¢
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ list // åˆ—è¡¨é¡µ æ”¯æŒå¤šå±‚åµŒå¥— å¦‚ list/module-a/module-bï¼Œå­ç›®å½•ç»“æ„åŒå¤–å±‚
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ â”œâ”€â”€ lib
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ â”œâ”€â”€ assets // ç»“æ„ä¸æœ€å¤–å±‚assetsä¸€æ ·
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ â”œâ”€â”€ components // ç»“æ„ä¸æœ€å¤–å±‚componentsä¸€æ ·
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ â”œâ”€â”€ hooks // ç»“æ„ä¸æœ€å¤–å±‚hooksä¸€æ ·
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ â”œâ”€â”€ stores // ç»“æ„ä¸æœ€å¤–å±‚storesä¸€æ ·
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ â”œâ”€â”€ api  // ç»“æ„ä¸æœ€å¤–å±‚apiä¸€æ ·
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ â”œâ”€â”€ constants // ç»“æ„ä¸æœ€å¤–å±‚constantsä¸€æ ·
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ â”œâ”€â”€ styles // ç»“æ„ä¸æœ€å¤–å±‚stylesä¸€æ ·
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ â”œâ”€â”€ types// ç»“æ„ä¸æœ€å¤–å±‚typesä¸€æ ·
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ index.tsx
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ detail // è¯¦æƒ…é¡µ å­ç›®å½•åŒ
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ index.tsx
â”‚Â Â  â”‚Â Â  â””â”€â”€ page-b
```



## â‡ï¸ POI æ–¹æ¡ˆ

### âœ… ä¸€æœŸæ–¹æ¡ˆ

#### è·å– POI æ•°æ®

- ç­›é€‰æœ‰ç”¨çš„ POI å­—æ®µ (type / typeId)
- ç»„ç»‡æ•°æ®ç»“æ„

![image-20220723083715054](/Users/tian/Library/Application Support/typora-user-images/image-20220723083715054.png)

#### å±•ç¤º POI æ•°æ®

**ğŸŒŸ åŸºäº [GPUGridLayer](https://deck.gl/docs/api-reference/aggregation-layers/gpu-grid-layer) å±•ç¤º**

- å¯ä»¥å®è§‚å±•ç¤ºè¡Œæ”¿åŒºå—å†… (ä»¥æ·±åœ³å¸‚ä¸ºä¾‹) çš„ POI åˆ†å¸ƒ

  - åŸºäºåŒºå—å†…æ•°é‡å æ¯”æœ€å¤§çš„ POI å±•ç¤ºåŒºå—æƒé‡
  - å±•ç¤ºæ•´ä½“ POI çš„ç¯çŠ¶å æ¯”å›¾

- å¯ç»“åˆè½¨è¿¹ OD æ•°æ®å®šåˆ¶ä¸ªä½“ç”¨æˆ·æ´»åŠ¨é“¾

  - OD èµ‹äºˆ POI å±æ€§ï¼Œæ„æˆä¸€å¤©/ä¸€å‘¨/ä¸€æœˆçš„è½¨è¿¹æ´»åŠ¨é“¾

  - åŸºäºæ´»åŠ¨é“¾å¯è¡ç”Ÿå‡ºæ›´å¤šçš„æ•°æ®åˆ†ææ–¹æ¡ˆåŠå›¾è¡¨ğŸ“ˆå±•ç¤º

    - å•æ¡è½¨è¿¹æ´»åŠ¨é“¾ (å¤šè¡¨è”åŠ¨)

      - æŠ˜çº¿å›¾ï¼šPOI å æ¯”åœ¨å„æ—¶é—´(è½¨è¿¹)èŠ‚ç‚¹çš„å±•ç¤º
      - ç¯çŠ¶å›¾ï¼šæŸæ—¶é—´(è½¨è¿¹)èŠ‚ç‚¹çš„ POI å æ¯”

      

![image-20220723082726807](/Users/tian/Library/Application Support/typora-user-images/image-20220723082726807.png)

#### POI æ•°æ®äº¤äº’

- é¼ æ ‡ Hover å±•ç¤º Tooltipï¼Œå†…å®¹åŒ…å«ï¼š
  - POI æ€»æ•°
  - å„ç±» POI æ•°ç›®
- é¼ æ ‡ç‚¹å‡»æŸåŒºå—ï¼Œè‡ªé€‚åº”æ”¾å¤§è¯¥åŒºå—ï¼Œå¹¶ä¸‹é’»åˆ°æ›´ç»†ç²’åº¦ POI
  - ä¸‹é’»æ•ˆæœçš„å±•ç¤ºæ–¹å¼ (ç»§ç»­é‡‡ç”¨ grid-layer è¿˜æ˜¯æ”¹ä¸ºé‡‡ç”¨ icon-layer)
  - ä¸‹é’»æ•ˆæœçš„è¿‡æ¸¡æ–¹å¼
  - å±•ç¤ºå½“å‰åŒºåŸŸçš„ç¯çŠ¶å æ¯”å›¾
  - æ”¯æŒå›é€€æ“ä½œ
  - æ”¯æŒåŒ(å¤š)é€‰æ“ä½œï¼Œä¸¤ä¸¤åŒºå—é—´ä»¥ [GreatCircleLayer](https://deck.gl/docs/api-reference/geo-layers/great-circle-layer) è¿æ¥ (å¯å®ç°åŒºåŸŸ POI ç§ç±»å æ¯”çš„é™æ€å¯¹æ¯”åˆ†æ)
